<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>DramaBox Web</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: white;
}
header {
  padding: 12px;
  background: #020617;
  text-align: center;
  font-weight: bold;
}
nav {
  display: flex;
  overflow-x: auto;
  gap: 8px;
  padding: 10px;
}
button {
  background: #1e293b;
  border: none;
  color: white;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  white-space: nowrap;
}
button:hover {
  background: #334155;
}
#list {
  padding: 10px;
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(140px,1fr));
  gap: 12px;
}
.card {
  background: #020617;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
}
.card img {
  width: 100%;
  height: 200px;
  object-fit: cover;
}
.card h4 {
  font-size: 14px;
  padding: 6px;
}
video {
  width: 100%;
  max-height: 80vh;
  background: black;
}
</style>
</head>

<body>

<header>üé¨ DramaBox Web</header>

<nav>
  <button onclick="loadData('vip')">VIP</button>
  <button onclick="loadData('random')">Random</button>
  <button onclick="loadData('foryou')">For You</button>
  <button onclick="loadData('latest')">Latest</button>
  <button onclick="loadData('trending')">Trending</button>
  <button onclick="loadData('dubindo')">Dub Indo</button>
</nav>

<div id="player"></div>
<div id="list"></div>

<script>
const BASE = "https://dramabox-proxy.annasmashuri97.workers.dev";

async function loadData(endpoint) {
  document.getElementById("list").innerHTML = "Loading...";
  document.getElementById("player").innerHTML = "";

  try {
    const res = await fetch(`${BASE}/${endpoint}`);
    const json = await res.json();
    const data = json.data || json;

    document.getElementById("list").innerHTML = "";

    data.forEach(item => {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img src="${item.cover || item.thumbnail || ''}">
        <h4>${item.title || 'Tanpa Judul'}</h4>
      `;
      card.onclick = () => play(item);
      document.getElementById("list").appendChild(card);
    });

  } catch (err) {
    document.getElementById("list").innerHTML = "‚ùå Gagal load data";
    console.error(err);
  }
}

function play(item) {
  const videoUrl =
    item.video ||
    item.play_url ||
    item.url ||
    "";

  if (!videoUrl) {
    alert("Video tidak tersedia");
    return;
  }

  document.getElementById("player").innerHTML = `
    <video controls autoplay>
      <source src="${videoUrl}">
    </video>
  `;
}

// auto load
loadData('random');
</script>

</body>
</html>
